generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  id        Int    @id @default(autoincrement())
  username  String @unique
  email     String @unique
  password  String
  status_id Int

  status     status       @relation(fields: [status_id], references: [id])
  wallets    wallets[]
  categories categories[]
  api_keys   api_keys[]
}

model api_keys {
  id      Int    @id @default(autoincrement())
  user_id Int
  code    String @unique

  users users @relation(fields: [user_id], references: [id])
}

model status {
  id   Int    @id @default(autoincrement())
  name String

  users users[]
}

model currencies {
  id           Int    @id @default(autoincrement())
  name         String
  abbreviation String

  wallets wallets[]
}

model account_type {
  id   Int    @id @default(autoincrement())
  name String

  wallets wallets[]
}

model wallets {
  id              Int    @id @default(autoincrement())
  name            String
  user_id         Int
  account_type_id Int
  currency_id     Int

  currencies    currencies     @relation(fields: [currency_id], references: [id])
  account_types account_type   @relation(fields: [account_type_id], references: [id])
  users         users          @relation(fields: [user_id], references: [id])
  transactions  transactions[]
}

model transaction_types {
  id   Int    @id @default(autoincrement())
  name String

  categories categories[]
}

model categories {
  id                  Int     @id @default(autoincrement())
  user_id             Int?
  transaction_type_id Int
  name                String
  is_global           Boolean

  users             users?            @relation(fields: [user_id], references: [id])
  transaction_types transaction_types @relation(fields: [transaction_type_id], references: [id])
  transactions      transactions[]
}

model transactions {
  id          Int        @id @default(autoincrement())
  category_id Int
  wallet_id   Int
  date        DateTime
  amount      Float
  description String
  categories  categories @relation(fields: [category_id], references: [id])
  wallets     wallets    @relation(fields: [wallet_id], references: [id])
}
